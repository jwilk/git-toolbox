#!/bin/sh

# Copyright Â© 2017 Jakub Wilk <jwilk@jwilk.net>
# SPDX-License-Identifier: MIT

set -e -u
url="$1"
name=$(basename "${url%.git}")
tmpdir=$(mktemp -d -t git-mk-bundle.XXXXXX)
git clone --bare "$url" "$tmpdir/repo"
git -C "$tmpdir/repo" bundle create "$PWD/${name}.gb" --all
rm -rf "$tmpdir"
